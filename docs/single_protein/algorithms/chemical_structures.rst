Chemical Structures
===================
For aromatic and conjugated residues, a chemical graph is constructed, consisting of the O, C, N, P and S atoms in the residue. 
When constructing this graph, an edge is only drawn between two atoms j and k if:

.. math::
   r_{\text{jk}} \leq \ \ \overline{x} - 2\sigma_{\overline{x}}

where x is the mean single-bond distance between those two elements,
and Ïƒx is the standard deviation. As one would expect, the structures generated by this criterion is not always correct, 
often due to poor resolution in PDBs. We have two functions which try to correct the chemical graph in order to 
generate proper structures. The first is :func:`~pyemap.structures.cleanup_bonding()`, which connects atoms that are 
within experimental single bond lengths and are only connected to 1 or 2 neighbors. This function often fixes broken aromaticity. 
The second is :func:`~pyemap.structures.remove_side_chains()` which recursively removes non-aromatic side chains from aromatic moieties. Once we have 
a proper chemical graph, a two pass depth first search algorithm is used to generate SMARTS_ strings for visualization.

The SMARTS strings generated using this procedure are stored in the `smarts` dictionary of the
:class:`~pyemap.emap` object. The keys are the node labels.

    >>> print(my_emap.smarts["W400(A)"])
    >>> c1cnc2c1cccc2

.. _SMARTS: https://en.wikipedia.org/wiki/SMILES_arbitrary_target_specification

.. autosummary::
   :toctree: autosummary

   pyemap.structures.buildSmarts
   pyemap.structures.getClosures
   pyemap.structures.getSimpleSmarts
   pyemap.structures.cleanup_bonding
   pyemap.structures.remove_side_chains
